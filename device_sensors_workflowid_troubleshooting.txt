[트러블슈팅]
워크플로우 생성 시 "Unknown column 'workflow_id' in 'where clause'" 오류

1. 증상
- 워크플로우 생성 또는 디바이스-센서 연결 저장 시 아래와 같은 에러 발생:
  Error: 디바이스-센서 연결 저장 중 오류가 발생했습니다: Unknown column 'workflow_id' in 'where clause'

2. 원인
- 데이터베이스의 device_sensors 테이블에 workflow_id 컬럼이 존재하지 않음.
- 코드(또는 마이그레이션)에서는 workflow_id 컬럼을 사용하려고 하지만, 실제 테이블 구조에는 해당 컬럼이 없어 SQL 오류가 발생함.

3. 진단 방법
1) DB에서 테이블 구조 확인
   DESCRIBE device_sensors;
   - 결과에 workflow_id 컬럼이 없으면, 컬럼이 누락된 상태임.
2) 마이그레이션 파일 또는 테이블 생성 SQL 확인
   - workflow_id 컬럼이 정의되어 있는지 확인.

4. 해결 방법
(1) 컬럼 직접 추가
MySQL 콘솔 또는 DB 툴에서 아래 쿼리 실행:
ALTER TABLE device_sensors ADD COLUMN workflow_id INT NOT NULL AFTER id;

(2) 외래키 제약조건도 필요하다면
ALTER TABLE device_sensors
  ADD COLUMN workflow_id INT NOT NULL AFTER id,
  ADD CONSTRAINT fk_device_sensors_workflow
    FOREIGN KEY (workflow_id) REFERENCES workflows(workflow_id) ON DELETE CASCADE;

(3) 마이그레이션 파일로 관리한다면
- 새로운 마이그레이션 파일을 만들어 위 쿼리를 실행하도록 작성.

5. 적용 후 확인
- 다시 워크플로우 생성/저장 시도
- 더 이상 Unknown column 'workflow_id' 오류가 발생하지 않아야 함

6. 추가 팁
- 개발 환경에서는 테이블을 드롭 후 재생성해도 되지만, 운영 환경에서는 반드시 데이터 유실에 주의해서 ALTER TABLE로 컬럼만 추가하세요.
- 마이그레이션 시스템을 사용 중이라면, DB 구조와 마이그레이션 파일이 항상 일치하는지 주기적으로 점검하세요. 